import sqlite3
from config import DATABASE_PATH

def fill_pribor_subsections():
    conn = sqlite3.connect(DATABASE_PATH)
    cursor = conn.cursor()

    # 1. Находим раздел 4.2
    cursor.execute("SELECT id FROM sections WHERE code LIKE '4.2%'")
    res = cursor.fetchone()
    if not res:
        print("Раздел 4.2 не найден!")
        return
    section_id = res[0]

    # 2. Список подразделов
    subsections = [
        "Негерметична статическая проводка анероидно-мембранных приборов",
        "Негерметична динамическая проводка анероидно-мембранных приборов",
        "Неверные показания курса ГИК-1",
        "Гироиндукционный компас ГИК-1 вяло реагирует на изменение курса при разворотах самолета",
        "Гирополукомпас ГПК-52 АП за короткое время уходит с курса",
        "Неправильное счисление НИ-50 БМК",
        "В полете автопилот АП-28Л1 уводит самолет с курса в режиме \"ГИК\"",
        "В полете автопилот АП-28Л1 уводит самолет с курса в режиме \"ГПК\"",
        "В полете автопилот АП-28Л1 не держит высоту",
        "При включении левого АГД-1 нет автоматического запуска ПТ-200Ц",
        "При включении АГБ-3 или ГИК-1 нет автоматического запуска ПТ-200Ц",
        "Блок контроля кренов БКК-18 выдает ложные сигналы об отказе авиагоризонтов",
        "Неправильные показания топливомера СПУТ1-5ВЕ",
        "Несрабатывание или ложное срабатывание сигнализации \"Обледенение\" от РИО-3",
        "При проверке ССП-2А встроенным контролем не загорается лампа-кнопка от определенной группы датчиков",
        "Самопроизвольное срабатывание 1-й очереди пожаротушения",
        "Падение давления по манометру кислородного указателя ИК-18К",
        "Не мигает сигнальная лампа \"Работа ЛПМ\""
    ]

    # 3. Вставка
    count = 0
    for name in subsections:
        # Проверяем на дубликаты
        cursor.execute("SELECT id FROM subsections WHERE section_id = ? AND name = ?", (section_id, name))
        if not cursor.fetchone():
            cursor.execute("INSERT INTO subsections (section_id, name) VALUES (?, ?)", (section_id, name))
            count += 1

    conn.commit()
    conn.close()
    print(f"Успешно добавлено {count} подразделов в раздел 4.2")

if __name__ == "__main__":
    fill_pribor_subsections()
